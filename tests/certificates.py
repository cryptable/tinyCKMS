from tinyCKMS.certificates import add_certificate, Certificate


test_cert = """
-----BEGIN CERTIFICATE-----
MIIFJTCCBA2gAwIBAgISA08QE7JXzaSM+dcf5xC8CuQtMA0GCSqGSIb3DQEBCwUA
MDIxCzAJBgNVBAYTAlVTMRYwFAYDVQQKEw1MZXQncyBFbmNyeXB0MQswCQYDVQQD
EwJSMzAeFw0yMTA5MDgxNDE4MzFaFw0yMTEyMDcxNDE4MzBaMBoxGDAWBgNVBAMT
D3RzYS5jYXJkcGx1cy5zZTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEB
AKjUlgRnkDbxhXSAJaF+5sbC23Ks8aIWJy2mHiatFCDpfpm5cOgf6t/dITQDl9FJ
aJ/z0sPHc/g/Habu7J/d/hFtF5srxPdizgg8RdPfH2XfPL0mtJd3XJh7b3zDeHkx
cDMQJihEGBD+UZekWlagJq0TiNJkmUtZasqz2YDBnVaAEdt4a/DM0Hp9QMnreMYS
jmywI+dnIxX6i/MOPrmm6QjsAUJ6iEg8p8q2Io5ADwSAw7O8NYp4d1Y6eQN41xVu
wj9DSXOTJ1WMC16lNT1VaFyVyC1zBmeE+/JsdCTkb1fVI6aK9fW9mpMjgoqFgTKK
kOFb9lfLkVHD4syYZEj2qJkCAwEAAaOCAkswggJHMA4GA1UdDwEB/wQEAwIFoDAd
BgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwDAYDVR0TAQH/BAIwADAdBgNV
HQ4EFgQU+kqhW/Jcb6bbtNr7CXUc9uT5jW8wHwYDVR0jBBgwFoAUFC6zF7dYVsuu
UAlA5h+vnYsUwsYwVQYIKwYBBQUHAQEESTBHMCEGCCsGAQUFBzABhhVodHRwOi8v
cjMuby5sZW5jci5vcmcwIgYIKwYBBQUHMAKGFmh0dHA6Ly9yMy5pLmxlbmNyLm9y
Zy8wGgYDVR0RBBMwEYIPdHNhLmNhcmRwbHVzLnNlMEwGA1UdIARFMEMwCAYGZ4EM
AQIBMDcGCysGAQQBgt8TAQEBMCgwJgYIKwYBBQUHAgEWGmh0dHA6Ly9jcHMubGV0
c2VuY3J5cHQub3JnMIIBBQYKKwYBBAHWeQIEAgSB9gSB8wDxAHcAXNxDkv7mq0VE
sV6a1FbmEDf71fpH3KFzlLJe5vbHDsoAAAF7xf049wAABAMASDBGAiEAy7+Z3ntG
ultDynPj7vzKwEMBltmErXjlUWdbzDpMcewCIQCu2zRfp5sAER7HcyVNxL5G9C6v
oGDeUs0p7bLfsHhJpgB2APZclC/RdzAiFFQYCDCUVo7jTRMZM7/fDC8gC8xO8WTj
AAABe8X9OPMAAAQDAEcwRQIhAM2+tYQun3tN/RXYJMgzV8T1xKUSGd0gQqVpJEw/
ot3VAiBBbkPDUoEC+G3X6AF9g8vxOmiyySM5RAreFj9mArAWNDANBgkqhkiG9w0B
AQsFAAOCAQEApV/9yamLRvKidOs9tAdptezmeJ5fpmQOC/INLDzWWSV7qMqgDbDZ
gI+24lHSf0Y/+oTD68pH35FRIqO+krbBMRZwnKeryu4XtdNIObMOJZBcQXLRJ05n
+SEmwD4b9KC0kBPBTd01ZwjgbYCchmZscLUh1eyZO0nrQc10WoqtEEnd0QG+EI88
X9BA5iA7Q5OeDdjzDlAKDDSgWp8VuwruGLVI8VBs4hpJs0SKmLb9ErmY/JahgLSh
OuVUEFnITh/DufXssRh5E3Wb/qmjwMFDq+f/Nr8/nl4ExVWFSGgadYe7dJjva7Hi
kwP3NeMgFiza7Ezu77dGjPmdtM5aopO66g==
-----END CERTIFICATE-----
"""


def test_add_certificate(app):

    with app.app_context():
        add_certificate(test_cert)

    assert Certificate.query.filter_by(subjet_cn='tsa.cardplus.se').first()
